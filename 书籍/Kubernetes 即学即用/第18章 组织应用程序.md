## 第18章 组织应用程序

1. 应该将YAML对象组成的文件系统作为应用程序的真实情况。而部署到Kubernetes集群中的API对象只是反应了存储在文件系统在的真实情况。

2. 发布的代码或者更改的配置在上生产环境之前必须经过审核。

3. 在大型项目中，为了提供关注点分离，通常将源代码和配置分开比较合理。

4. 特性门控的基本思想是，在开发新功能时，整个开发工作都在某个特性门控的后面进行。

   '''if(flag){}'''

5. 应该从一开始就采用正确的组织方式。就像修改源代码管理中的程序包布局一样，事后再修改部署配置非常频繁且代价惨重，应该尽可能避免。

6. 各个应用程序的配置都存储在格子的目录中。这些配置就是直接代表集群当前状态的YAML。（同一类对象一个文件定义）

7. 开发人员必须能够在自己的环境中工作，并且能够访问所有的服务。

8. 发布的阶段：

   1. HEAD：最前沿，最新变化
   2. 开发：基本稳定，但尚未准备好进行部署。适合开发人员构建功能。
   3. 预发布：测试的开始，除非发现问题，否则不太可能变化。
   4. 金丝雀：向用户发布的第一个版本，用于在真实世界中册数问题，也可以为用户提供尝试新功能的机会。
   5. 发布：当前的生产版本。

9. 应用程序的全球部署应该由多个不同的Kubernetes集群组成，每个集群都有各自的应用程序配置。一般在等待大约2~3个平均冒烟时间之后，就可以放心地开始下一个区域了。

10. 一般，推出首先应该从流量较低的区域开始。这样可以确保将遇到的早期问题限制在影响较小的区域。

11. 最佳实践是活动版本的数量不要超过三个：一个测试版本，一个推出版本，一个被推出替换下来的版本。